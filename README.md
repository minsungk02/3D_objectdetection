# 3D Object Detection with PointPillars on nuScenes-Mini

![Python](https://img.shields.io/badge/Python-3.10%2B-blue)
![PyTorch](https://img.shields.io/badge/PyTorch-2.0%2B-orange)
![MMDetection3D](https://img.shields.io/badge/MMDetection3D-v1.4-green)
![Status](https://img.shields.io/badge/Status-Completed-success)

## ðŸ“– í”„ë¡œì íŠ¸ ê°œìš”
ë³¸ í”„ë¡œì íŠ¸ëŠ” **MMDetection3D** í”„ë ˆìž„ì›Œí¬ ë‚´ì—ì„œ **PointPillars** ì•„í‚¤í…ì²˜ë¥¼ ì‚¬ìš©í•˜ì—¬ **LiDAR ê¸°ë°˜ 3D ê°ì²´ íƒì§€(3D Object Detection)** ì‹œìŠ¤í…œì„ êµ¬í˜„í•˜ê¸° ìœ„í•œ í”„ë¡œì íŠ¸ìž…ë‹ˆë‹¤.
**Google Colab L4 GPU** í™˜ê²½ì— ë§žì¶° í•™ìŠµ íŒŒì´í”„ë¼ì¸ì„ ìµœì í™”í•˜ê³ , ì œí•œëœ ë°ì´í„°ì…‹ì¸ **nuScenes v1.0-mini** í™˜ê²½ì—ì„œì˜ ì„±ëŠ¥ íŠ¹ì„±ê³¼ í•œê³„ì ì„ ë¶„ì„í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ ì„¤ì •í–ˆìŠµë‹ˆë‹¤.

## ðŸ› ï¸ ê°œë°œ í™˜ê²½ ë° ê¸°ìˆ  ìŠ¤íƒ
* **í•˜ë“œì›¨ì–´:** Google Colab L4 GPU (VRAM 24GB)
* **í”„ë ˆìž„ì›Œí¬:** MMDetection3D (OpenMMLab)
* **ë°ì´í„°ì…‹:** nuScenes v1.0-mini (10ê°œ ì”¬)
* **ëª¨ë¸:** PointPillars (Hard Voxelization, SECOND FPN)

## âš™ï¸ í•™ìŠµ ì„¤ì • ìµœì í™” ì „ëžµ (L4 GPU ê¸°ì¤€)
í•˜ë“œì›¨ì–´ ì œì•½ ë° ë°ì´í„°ì…‹ì˜ íŠ¹ì„±ì„ ê³ ë ¤í•˜ì—¬ Config íŒŒì¼ì„ ë‹¤ìŒê³¼ ê°™ì´ íŠœë‹í–ˆìŠµë‹ˆë‹¤.

| íŠœë‹ í•­ëª© | ì„¤ì •ê°’ | ì„ ì • ê·¼ê±° |
| :--- | :--- | :--- |
| **Batch Size** | `4` | L4 GPU ë©”ëª¨ë¦¬ ì•ˆì •ì„± í™•ë³´ ë° OOM(Out Of Memory) ë°©ì§€. |
| **Sweeps** | `10` | í¬ì†Œí•œ(Sparse) ë¼ì´ë‹¤ í¬ì¸íŠ¸ ë°€ë„ë¥¼ ë†’ì´ê¸° ìœ„í•´ ê³¼ê±° 10í”„ë ˆìž„ ëˆ„ì  ì‚¬ìš©. |
| **Scheduler** | `30 Epochs` | ì ì€ ë°ì´í„°ë¡œ ìµœëŒ€í•œì˜ íŠ¹ì§•ì„ í•™ìŠµí•˜ê¸° ìœ„í•´ í‘œì¤€(24 Epoch)ë³´ë‹¤ ê¸¸ê²Œ ì„¤ì •. |
| **Precision** | `AMP` | ìžë™ í˜¼í•© ì •ë°€ë„(FP16)ë¥¼ ì‚¬ìš©í•˜ì—¬ ë©”ëª¨ë¦¬ íš¨ìœ¨ì„± ê·¹ëŒ€í™”. |

## ðŸ’¥ ì£¼ìš” íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ë° í•´ê²° ê³¼ì •
í•™ìŠµ íŒŒì´í”„ë¼ì¸ êµ¬ì¶• ì¤‘ ë°œìƒí•œ **In-training Validation ì‹¤íŒ¨ ì´ìŠˆ**ë¥¼ ë¶„ì„í•˜ê³ , **Offline Validation ì „ëžµ**ì„ í†µí•´ í•´ê²°í–ˆìŠµë‹ˆë‹¤.

### 1. ë°œìƒí•œ ë¬¸ì œ (Issue)
* **í˜„ìƒ:** `train.py` ì‹¤í–‰ ì‹œ, í•™ìŠµ(Train) ë‹¨ê³„ëŠ” ì •ìƒ ì§„í–‰ë˜ë‚˜ ê²€ì¦(Validation) ë‹¨ê³„ ì§„ìž… ì‹œ ì—ëŸ¬ ë°œìƒ ë° í”„ë¡œì„¸ìŠ¤ ì¤‘ë‹¨.
* **ì—ëŸ¬ ë©”ì‹œì§€:**
  > `AssertionError: Samples in split doesn't match samples in predictions.`
  > `TypeError: NuScenesMetric.init() got an unexpected keyword argument 'version'`
* **ì›ì¸ ë¶„ì„:**
  1.  **ë°ì´í„°ì…‹ ë¶ˆì¼ì¹˜:** `v1.0-mini` ë°ì´í„°ì…‹ì„ ì‚¬ìš©í–ˆìœ¼ë‚˜, ë‚´ë¶€ í‰ê°€ ë¼ì´ë¸ŒëŸ¬ë¦¬(nuscenes-devkit)ê°€ ê¸°ë³¸ ì„¤ì •ì¸ ì „ì²´ ë°ì´í„°ì…‹(trainval) ë¦¬ìŠ¤íŠ¸ì™€ ëŒ€ì¡°í•˜ì—¬ ìƒ˜í”Œ ê°œìˆ˜ ë¶ˆì¼ì¹˜ ë°œìƒ.
  2.  **ë²„ì „ í˜¸í™˜ì„±:** MMDet3Dì˜ Config íŒŒì¼ ì„¤ì •ê³¼ ë‚´ë¶€ ì†ŒìŠ¤ ì½”ë“œ ê°„ì˜ `version` ì¸ìž ì „ë‹¬ ê³¼ì •ì—ì„œ ì¶©ëŒ ë°œìƒ.

### 2. í•´ê²° ì „ëžµ (Resolution Strategy)

**âœ… [Step 1] ì „ëžµ ìˆ˜ì •: "Validation Bypass" (ê²€ì¦ ì œì™¸)**
* í•™ìŠµ ë„ì¤‘ ì—ëŸ¬ë¥¼ ìœ ë°œí•˜ëŠ” í‰ê°€(Evaluator) í”„ë¡œì„¸ìŠ¤ë¥¼ ì•„ì˜ˆ ì‹¤í–‰í•˜ì§€ ì•Šë„ë¡ Configë¥¼ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤.
* **ì¡°ì¹˜ ë‚´ìš©:**
  * `val_evaluator`, `val_dataloader` ì„¤ì •ì„ `None`ìœ¼ë¡œ ì œê±°.
  * `val_interval`ì„ `9999`ë¡œ ì„¤ì •í•˜ì—¬ í•™ìŠµ ì¤‘ í‰ê°€ ë‹¨ê³„ ì§„ìž…ì„ ì›ì²œ ì°¨ë‹¨.
* **ê²°ê³¼:** ì—ëŸ¬ ì—†ì´ `train.py`ê°€ ì™„ì£¼í•˜ê³  ëª¨ë¸ íŒŒì¼(.pth)ì´ ì •ìƒì ìœ¼ë¡œ ìƒì„±ë¨.

**baseline config íŒŒì¼ì„ ê°€ì ¸ì™€ val ê²€ì¦ì„ ë„ê¸°.**
'''bash
### ê²€ì¦ ë„ê¸° (í•™ìŠµ ì¤‘ ì—ëŸ¬ ë°©ì§€)
val_cfg = None
val_dataloader = None
val_evaluator = None

**âœ… [Step 2] ìµœì¢… ì›Œí¬í”Œë¡œìš°: "Offline Validation" (ì˜¤í”„ë¼ì¸ ê²€ì¦)**
í•™ìŠµê³¼ í‰ê°€ë¥¼ ë¶„ë¦¬í•˜ì—¬ ì•ˆì •ì„±ì„ í™•ë³´í•˜ê³  ìµœì ì˜ ëª¨ë¸ì„ ì„ ì •í•˜ëŠ” íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í–ˆìŠµë‹ˆë‹¤.
1.  **Long Training:** ì¶©ë¶„í•œ í•™ìŠµì„ ìœ„í•´ 30 Epochìœ¼ë¡œ ì„¤ì •.
2.  **Frequent Saving:** 5 Epoch ë§ˆë‹¤ ì²´í¬í¬ì¸íŠ¸(`epoch_5.pth`, `epoch_10.pth`...) ìžë™ ì €ìž¥.
3.  **Post-Evaluation:** í•™ìŠµ ì¢…ë£Œ í›„, ì €ìž¥ëœ ëª¨ë“  ëª¨ë¸ì— ëŒ€í•´ ë³„ë„ë¡œ `test.py`ë¥¼ ì‹¤í–‰í•˜ì—¬ JSON ê²°ê³¼ ìƒì„±.
4.  **Best Model Selection:** `nuscenes-devkit`ì„ ì´ìš©í•´ ê° ëª¨ë¸ì˜ mAP / NDS ì ìˆ˜ë¥¼ ì‚°ì¶œí•˜ê³ , ìµœê³  ì„±ëŠ¥ ëª¨ë¸ì„ ìµœì¢… ì„ ì •.

## ðŸ“Š ì‹¤í—˜ ê²°ê³¼

### 1. ì •ëŸ‰ì  ë¶„ì„ (Metrics)
Offline Validation ë°©ì‹ìœ¼ë¡œ ì‚°ì¶œëœ ìµœì¢… ê²°ê³¼ìž…ë‹ˆë‹¤.

| ì§€í‘œ | ì ìˆ˜ | ë¶„ì„ |
| :--- | :--- | :--- |
| **mAP** | **3.69%** | Mini ë°ì´í„°ì…‹ì˜ ì ˆëŒ€ì ì¸ ë°ì´í„° ë¶€ì¡±ìœ¼ë¡œ ì¸í•´ ì „ì²´ í‰ê·  ì •í™•ë„ëŠ” ë‚®ìŒ. |
| **NDS** | **10.66%** | mAP ëŒ€ë¹„ ë†’ì€ ì ìˆ˜ë¥¼ ê¸°ë¡, íƒì§€ëœ ê°ì²´ì˜ ìœ„ì¹˜/ë°©í–¥ ì¶”ì •ì€ ìœ ì˜ë¯¸í•¨ì„ ì‹œì‚¬. |
| **Car AP** | **26.0%** | **ì„±ê³µ ì‚¬ë¡€.** ê°€ìž¥ ë°ì´í„°ê°€ ë§Žì€ 'ìžë™ì°¨' í´ëž˜ìŠ¤ëŠ” ìœ ì˜ë¯¸í•œ í•™ìŠµ ì„±ê³¼ë¥¼ ë³´ìž„. |
| **Pedestrian AP** | **6.8%** | Voxel í•´ìƒë„(0.25m)ì˜ í•œê³„ë¡œ ìž‘ì€ ê°ì²´ íƒì§€ì— ì–´ë ¤ì›€ì´ ìžˆìŒ. |
| **Other AP** | 0.0% | íŠ¸ëŸ­, ìžì „ê±° ë“± í¬ê·€ í´ëž˜ìŠ¤ëŠ” í•™ìŠµ ìƒ˜í”Œ ë¶€ì¡±ìœ¼ë¡œ íƒì§€ ì‹¤íŒ¨. |

### 2. ì •ì„±ì  ë¶„ì„ (ì‹œê°í™”)
Ground Truth(ì •ë‹µ)ì™€ Prediction(ì˜ˆì¸¡)ì„ ë¹„êµ ì‹œê°í™”í•˜ì—¬ ë¶„ì„í–ˆìŠµë‹ˆë‹¤.

*(ì—¬ê¸°ì— ìƒì„±í•˜ì‹  summary_pr_curve.png ë˜ëŠ” ì‹œê°í™” ì´ë¯¸ì§€ë¥¼ ë„£ìœ¼ì„¸ìš”)*

> **ê´€ì°° ê²°ê³¼:**
> * **ì´ˆë¡ìƒ‰ ë°•ìŠ¤ (GT):** ì‹¤ì œ ê°ì²´
> * **ë¹¨ê°„ìƒ‰ ë°•ìŠ¤ (Pred):** ëª¨ë¸ ì˜ˆì¸¡
> * ìžìœ¨ì£¼í–‰ ì°¨ëŸ‰ ê·¼ì²˜ì˜ **ìžë™ì°¨(Car)**ëŠ” ë§¤ìš° ì •í™•í•˜ê²Œ íƒì§€í•˜ë‚˜, ì›ê±°ë¦¬ ê°ì²´ë‚˜ ë°ì´í„°ê°€ ë¶€ì¡±í•œ **íŠ¹ìˆ˜ ì°¨ëŸ‰(ê±´ì„¤ìž¥ë¹„ ë“±)**ì€ íƒì§€í•˜ì§€ ëª»í•˜ëŠ” ê²½í–¥ì„ ë³´ìž„.

## ðŸ§ ì„±ëŠ¥ ë¶„ì„ ë° ê²°ë¡ 

### ì™œ ì´ëŸ° ê²°ê³¼ê°€ ë‚˜ì™”ëŠ”ê°€? (ì›ì¸ ë¶„ì„)
1.  **ë°ì´í„° ë¶€ì¡± (í•µì‹¬ ì›ì¸):** `v1.0-mini`ëŠ” ì „ì²´ ë°ì´í„°ì…‹ì˜ ì•½ 1% ìˆ˜ì¤€ìž…ë‹ˆë‹¤. ë”¥ëŸ¬ë‹ ëª¨ë¸ì´ ë‹¤ì–‘í•œ ê°ì²´ì˜ ì¼ë°˜ì ì¸ íŠ¹ì§•ì„ ë°°ìš°ê¸°ì—ëŠ” í„±ì—†ì´ ë¶€ì¡±í•œ ì–‘ìž…ë‹ˆë‹¤.
2.  **í´ëž˜ìŠ¤ ë¶ˆê· í˜•:** ì „ì²´ ë°ì´í„°ì˜ 90% ì´ìƒì´ ìžë™ì°¨ì™€ ë³´í–‰ìžì— íŽ¸ì¤‘ë˜ì–´ ìžˆì–´, í¬ê·€ í´ëž˜ìŠ¤(ìžì „ê±°, íŠ¸ëŸ­)ì— ëŒ€í•œ í•™ìŠµì´ ì´ë£¨ì–´ì§€ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.
3.  **Voxel í•´ìƒë„ì˜ í•œê³„:** `[0.25, 0.25]` í¬ê¸°ì˜ Voxelì€ ì°¨ëŸ‰ íƒì§€ì—ëŠ” ì í•©í•˜ë‚˜, ë³´í–‰ìžë‚˜ íŠ¸ëž˜í”½ ì½˜ ê°™ì€ ìž‘ì€ ë¬¼ì²´ë¥¼ í‘œí˜„í•˜ê¸°ì—ëŠ” í•´ìƒë„ê°€ ë„ˆë¬´ ë‚®ìŠµë‹ˆë‹¤.

### í–¥í›„ ê°œì„  ë°©ì•ˆ
* **ë°ì´í„° í™•ìž¥:** **nuScenes v1.0-trainval** (ì „ì²´ ë°ì´í„°ì…‹)ì„ ì‚¬ìš©í•˜ì—¬ í•™ìŠµ ì‹œ mAP 40% ì´ìƒ ë‹¬ì„± ì˜ˆìƒ.
* **ë°ì´í„° ì¦ê°•:** **CBGS (Class-Balanced Grouping and Sampling)** ê¸°ë²•ì„ ì ìš©í•˜ì—¬ í´ëž˜ìŠ¤ ë¶ˆê· í˜• í•´ì†Œ.
* **ëª¨ë¸ íŠœë‹:** ìž‘ì€ ë¬¼ì²´ íƒì§€ë¥¼ ìœ„í•´ Voxel í¬ê¸°ë¥¼ `0.16m` ë˜ëŠ” `0.075m` (CenterPoint ì„¤ì •)ë¡œ ë¯¸ì„¸í™”.

## ðŸš€ ì‹¤í–‰ ë°©ë²• (How to Run)
**-> ì²¨ë¶€í•œ ipynbì½”ë“œ ì°¸ì¡°.**
